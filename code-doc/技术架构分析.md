# RandomLife æŠ€æœ¯æ¶æ„æ·±åº¦åˆ†æ

## æ¶æ„æ¦‚è§ˆ

RandomLife é‡‡ç”¨äº†ç°ä»£åŒ–çš„å…¨æ ˆæ¶æ„ï¼ŒåŸºäº Next.js 14 App Router æ„å»ºï¼Œå®ç°äº†å‰åç«¯ä¸€ä½“åŒ–çš„å¼€å‘æ¨¡å¼ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å‰ç«¯ (React)   â”‚â”€â”€â”€â”€â”‚  API (Next.js)  â”‚â”€â”€â”€â”€â”‚  æ•°æ® (SQLite)   â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ â€¢ UI Components â”‚    â”‚ â€¢ Auth Routes   â”‚    â”‚ â€¢ User Data     â”‚
â”‚ â€¢ Client State  â”‚    â”‚ â€¢ API Routes    â”‚    â”‚ â€¢ Preferences   â”‚
â”‚ â€¢ Navigation    â”‚    â”‚ â€¢ Middleware    â”‚    â”‚ â€¢ Recommendationsâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## å‰ç«¯æ¶æ„åˆ†æ

### æŠ€æœ¯æ ˆè¯¦æƒ…

#### 1. æ¡†æ¶é€‰æ‹©ï¼šNext.js 14 (App Router)
```typescript
// app/layout.tsx - åº”ç”¨æ ¹å¸ƒå±€
export default function RootLayout({
  children,
}: {
  children: React.ReactNode
}) {
  return (
    <html lang="en">
      <body className={inter.className}>
        <ThemeProvider
          attribute="class"
          defaultTheme="system"
          enableSystem
          disableTransitionOnChange
        >
          <AuthProvider>
            {children}
          </AuthProvider>
        </ThemeProvider>
      </body>
    </html>
  )
}
```

**ä¼˜åŠ¿åˆ†æ**:
- âœ… **SEOå‹å¥½**: æœåŠ¡ç«¯æ¸²æŸ“æ”¯æŒ
- âœ… **æ€§èƒ½ä¼˜ç§€**: è‡ªåŠ¨ä»£ç åˆ†å‰²å’Œä¼˜åŒ–
- âœ… **å¼€å‘ä½“éªŒ**: çƒ­é‡è½½ã€å¿«é€Ÿåˆ·æ–°
- âœ… **ç±»å‹å®‰å…¨**: å®Œæ•´çš„TypeScriptæ”¯æŒ

#### 2. UIç»„ä»¶æ¶æ„ï¼šRadix UI + shadcn/ui

```typescript
// ç»„ä»¶è®¾è®¡æ¨¡å¼
interface ButtonProps extends React.ButtonHTMLAttributes<HTMLButtonElement> {
  variant?: 'default' | 'destructive' | 'outline' | 'secondary'
  size?: 'default' | 'sm' | 'lg'
}

export const Button: React.FC<ButtonProps> = ({ ...props }) => {
  return (
    <motion.button
      whileHover={{ scale: 1.05 }}
      whileTap={{ scale: 0.95 }}
      {...props}
    />
  )
}
```

**æ¶æ„ä¼˜åŠ¿**:
- âœ… **å¯è®¿é—®æ€§**: Radix UIæä¾›æ— éšœç¢æ”¯æŒ
- âœ… **å¯å®šåˆ¶æ€§**: åŸºäºTailwindçš„çµæ´»æ ·å¼
- âœ… **ç±»å‹å®‰å…¨**: å®Œæ•´çš„TypeScriptç±»å‹å®šä¹‰
- âœ… **åŠ¨ç”»é›†æˆ**: ä¸Framer Motionæ— ç¼é›†æˆ

#### 3. çŠ¶æ€ç®¡ç†ç­–ç•¥

```typescript
// è®¤è¯çŠ¶æ€ç®¡ç† - NextAuth
export default function HomePage() {
  const { data: session } = useSession()
  return (
    <div>
      {session ? <AuthenticatedUser /> : <GuestUser />}
    </div>
  )
}

// æœ¬åœ°çŠ¶æ€ç®¡ç† - useState + useEffect
const [recommendations, setRecommendations] = useState([])
const [isLoading, setIsLoading] = useState(false)
```

**çŠ¶æ€ç®¡ç†åˆ†æ**:
- âœ… **ç®€å•æœ‰æ•ˆ**: å¯¹äºå½“å‰éœ€æ±‚è¶³å¤Ÿä½¿ç”¨
- âœ… **æ€§èƒ½ä¼˜åŒ–**: å±€éƒ¨çŠ¶æ€é¿å…ä¸å¿…è¦çš„é‡æ¸²æŸ“
- âš ï¸ **æ‰©å±•æ€§é™åˆ¶**: å¤§å‹åº”ç”¨å¯èƒ½éœ€è¦çŠ¶æ€ç®¡ç†åº“

#### 4. æ ·å¼æ¶æ„ï¼šTailwind CSS + è®¾è®¡ç³»ç»Ÿ

```typescript
// é¢œè‰²ç³»ç»Ÿå®šä¹‰
const colors = {
  primary: '#FF6B6B',    // çŠç‘šçº¢
  secondary: '#4ECDC4',  // é’ç»¿
  background: '#F7F9FC', // æµ…ç°èƒŒæ™¯
  text: {
    primary: '#1A1A1A',
    secondary: '#6B7280'
  }
}

// å“åº”å¼è®¾è®¡
<div className="min-h-screen bg-[#F7F9FC] p-4">
  <div className="max-w-md mx-auto">
    {/* ç§»åŠ¨ä¼˜å…ˆçš„å“åº”å¼å¸ƒå±€ */}
  </div>
</div>
```

## åç«¯æ¶æ„åˆ†æ

### APIè®¾è®¡æ¨¡å¼

#### 1. RESTful APIè®¾è®¡

```typescript
// app/api/recommend/[category]/route.ts
export async function POST(
  request: NextRequest,
  { params }: { params: { category: string } }
) {
  // å‚æ•°éªŒè¯
  const { user_id } = await request.json()
  const category = params.category

  // ä¸šåŠ¡é€»è¾‘å¤„ç†
  let recommendation
  switch (category) {
    case "entertainment":
      recommendation = getRandomItem(ENTERTAINMENT)
      break
    // ...
  }

  return NextResponse.json(recommendation)
}
```

**è®¾è®¡åŸåˆ™**:
- âœ… **RESTful**: éµå¾ªRESTè®¾è®¡åŸåˆ™
- âœ… **ç±»å‹å®‰å…¨**: TypeScriptå‚æ•°éªŒè¯
- âœ… **é”™è¯¯å¤„ç†**: ç»Ÿä¸€çš„é”™è¯¯å“åº”æ ¼å¼
- âœ… **ä¸­é—´ä»¶æ”¯æŒ**: è®¤è¯ã€æ—¥å¿—ç­‰åŠŸèƒ½

#### 2. è®¤è¯æ¶æ„ï¼šNextAuth.js

```typescript
// app/api/auth/[...nextauth]/route.ts
export const authOptions: AuthOptions = {
  session: { strategy: 'jwt' },
  providers: [
    Credentials({
      authorize: async (credentials) => {
        const user = await prisma.user.findUnique({
          where: { email: credentials.email }
        })
        const valid = await bcrypt.compare(
          credentials.password,
          user.password
        )
        return valid ? { id: user.id, email: user.email } : null
      }
    })
  ],
  callbacks: {
    jwt: async ({ token }) => {
      // JWT tokenå¢å¼ºï¼Œæ·»åŠ ç”¨æˆ·æ•°æ®
      const dbUser = await prisma.user.findUnique({
        where: { email: token.email }
      })
      token.subscriptionTier = dbUser.subscriptionTier
      return token
    }
  }
}
```

**è®¤è¯æ¶æ„ä¼˜åŠ¿**:
- âœ… **å®‰å…¨æ€§**: bcryptå¯†ç å“ˆå¸Œï¼ŒJWT session
- âœ… **çµæ´»æ€§**: æ”¯æŒå¤šç§provideræ‰©å±•
- âœ… **ä¼šè¯ç®¡ç†**: è‡ªåŠ¨tokenåˆ·æ–°å’Œè¿‡æœŸå¤„ç†
- âœ… **ä¸­é—´ä»¶é›†æˆ**: ä¸Next.jsä¸­é—´ä»¶å®Œç¾é…åˆ

#### 3. æ•°æ®åº“æ¶æ„ï¼šPrisma + SQLite

```prisma
// prisma/schema.prisma
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model User {
  id               String   @id @default(cuid())
  email            String   @unique
  password         String
  subscriptionTier String   @default("free")
  subscriptionId   String?  // Stripe/PayPal ID
  paymentMethod    String?  // "stripe" or "paypal"
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt
}
```

**æ•°æ®åº“é€‰æ‹©åˆ†æ**:
- âœ… **å¼€å‘æ•ˆç‡**: Prismaæä¾›ç±»å‹å®‰å…¨çš„æ•°æ®åº“è®¿é—®
- âœ… **ç®€å•éƒ¨ç½²**: SQLiteæ— éœ€é¢å¤–æ•°æ®åº“æœåŠ¡
- âœ… **è¿ç§»ç®¡ç†**: è‡ªåŠ¨åŒ–çš„æ•°æ®åº“è¿ç§»
- âš ï¸ **æ‰©å±•æ€§é™åˆ¶**: å¤§è§„æ¨¡åº”ç”¨å¯èƒ½éœ€è¦PostgreSQL

## æ€§èƒ½æ¶æ„åˆ†æ

### å‰ç«¯æ€§èƒ½ä¼˜åŒ–

#### 1. ä»£ç åˆ†å‰²ç­–ç•¥

```typescript
// åŠ¨æ€å¯¼å…¥å¤§å‹ç»„ä»¶
const ProPage = dynamic(() => import('../app/pro/page'), {
  loading: () => <div>Loading...</div>
})

// è·¯ç”±çº§åˆ«ä»£ç åˆ†å‰² - Next.jsè‡ªåŠ¨å¤„ç†
// app/page.tsx, app/category/[id]/page.tsx ç­‰
```

#### 2. å›¾ç‰‡ä¼˜åŒ–ç­–ç•¥

```typescript
// å½“å‰çŠ¶æ€ï¼šä½¿ç”¨å ä½ç¬¦
<div className="w-32 h-32 bg-gray-200 rounded-lg">
  <span className="text-4xl">ğŸœ</span>
</div>

// ä¼˜åŒ–æ–¹æ¡ˆï¼šNext.js Imageç»„ä»¶
import Image from 'next/image'

<Image
  src="/food-placeholder.jpg"
  alt="æ¨èå›¾ç‰‡"
  width={128}
  height={128}
  className="rounded-lg"
  placeholder="blur"
  blurDataURL="data:image/jpeg;base64,..."
/>
```

#### 3. ç¼“å­˜ç­–ç•¥

```typescript
// æ¨èç»“æœç¼“å­˜
const recommendationCache = new Map()

async function getCachedRecommendation(category: string) {
  const cacheKey = `${category}-${Date.now() / (1000 * 60)}`

  if (recommendationCache.has(cacheKey)) {
    return recommendationCache.get(cacheKey)
  }

  const recommendation = await fetchRecommendation(category)
  recommendationCache.set(cacheKey, recommendation)

  // æ¸…ç†è¿‡æœŸç¼“å­˜
  if (recommendationCache.size > 100) {
    const oldestKey = recommendationCache.keys().next().value
    recommendationCache.delete(oldestKey)
  }

  return recommendation
}
```

### åç«¯æ€§èƒ½ä¼˜åŒ–

#### 1. æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–

```typescript
// å½“å‰å®ç°
const user = await prisma.user.findUnique({
  where: { email: credentials.email }
})

// ä¼˜åŒ–æ–¹æ¡ˆï¼šç´¢å¼•å’ŒæŸ¥è¯¢ä¼˜åŒ–
const user = await prisma.user.findUnique({
  where: { email: credentials.email },
  select: {
    id: true,
    email: true,
    subscriptionTier: true,
    password: true
  }
})
```

#### 2. APIå“åº”ä¼˜åŒ–

```typescript
// æ·»åŠ å“åº”ç¼“å­˜å¤´
export async function GET(request: NextRequest) {
  const data = await fetchData()

  return NextResponse.json(data, {
    headers: {
      'Cache-Control': 'public, max-age=3600', // 1å°æ—¶ç¼“å­˜
      'Content-Type': 'application/json'
    }
  })
}
```

## å®‰å…¨æ¶æ„åˆ†æ

### 1. è®¤è¯å®‰å…¨

```typescript
// å¯†ç å®‰å…¨å¤„ç†
import bcrypt from 'bcryptjs'

const hashedPassword = await bcrypt.hash(password, 10)
const isValid = await bcrypt.compare(password, hashedPassword)

// JWTå®‰å…¨é…ç½®
const authOptions: AuthOptions = {
  session: {
    strategy: 'jwt',
    maxAge: 24 * 60 * 60, // 24å°æ—¶è¿‡æœŸ
  },
  secret: process.env.NEXTAUTH_SECRET,
}
```

### 2. APIå®‰å…¨

```typescript
// è¾“å…¥éªŒè¯
import { z } from 'zod'

const recommendationSchema = z.object({
  user_id: z.string().min(1),
  category: z.enum(['entertainment', 'shopping', 'food', 'travel', 'fitness'])
})

// è®¤è¯ä¸­é—´ä»¶
export async function middleware(request: NextRequest) {
  const session = await getServerSession(authOptions)

  if (!session && request.nextUrl.pathname.startsWith('/api/protected')) {
    return NextResponse.json({ error: 'Unauthorized' }, { status: 401 })
  }

  return NextResponse.next()
}
```

### 3. æ•°æ®å®‰å…¨

```typescript
// æ•æ„Ÿæ•°æ®å¤„ç†
function sanitizeUserData(user: User) {
  const { password, ...sanitizedUser } = user
  return sanitizedUser
}

// ç¯å¢ƒå˜é‡ç®¡ç†
const config = {
  database: {
    url: process.env.DATABASE_URL,
  },
  stripe: {
    secretKey: process.env.STRIPE_SECRET_KEY,
    webhookSecret: process.env.STRIPE_WEBHOOK_SECRET,
  }
}
```

## æ‰©å±•æ€§åˆ†æ

### å½“å‰æ¶æ„ä¼˜åŠ¿

1. **æ¨¡å—åŒ–è®¾è®¡**: ç»„ä»¶åŒ–æ¶æ„ä¾¿äºåŠŸèƒ½æ‰©å±•
2. **ç±»å‹å®‰å…¨**: TypeScriptä¿è¯ä»£ç è´¨é‡
3. **APIæ ‡å‡†åŒ–**: RESTfulè®¾è®¡ä¾¿äºé›†æˆ
4. **æ•°æ®åº“æŠ½è±¡**: Prismaä¾¿äºæ•°æ®åº“åˆ‡æ¢

### æ‰©å±•æ€§é™åˆ¶

1. **å•ä½“æ¶æ„**: æ‰€æœ‰åŠŸèƒ½åœ¨åŒä¸€é¡¹ç›®ä¸­
2. **æ•°æ®åº“é™åˆ¶**: SQLiteä¸é€‚åˆå¤§è§„æ¨¡éƒ¨ç½²
3. **ç¼“å­˜ç®€å•**: ç¼ºä¹åˆ†å¸ƒå¼ç¼“å­˜
4. **ç›‘æ§ä¸è¶³**: ç¼ºä¹å®Œæ•´çš„ç›‘æ§ä½“ç³»

### æ‰©å±•å»ºè®®

```typescript
// 1. å¾®æœåŠ¡æ¶æ„è¿ç§»
// æ¨èæœåŠ¡ç‹¬ç«‹
// app/recommendations/service.ts
export class RecommendationService {
  async getRecommendations(userId: string, category: string) {
    // ç‹¬ç«‹çš„æ¨èé€»è¾‘
  }
}

// 2. ç¼“å­˜å±‚å¼•å…¥
import Redis from 'ioredis'

const redis = new Redis(process.env.REDIS_URL)

async function getCachedRecommendation(key: string) {
  const cached = await redis.get(key)
  return cached ? JSON.parse(cached) : null
}

// 3. æ¶ˆæ¯é˜Ÿåˆ—å¼•å…¥
import Bull from 'bull'

const recommendationQueue = new Bull('recommendation processing')

recommendationQueue.process(async (job) => {
  const { userId, category } = job.data
  // å¼‚æ­¥å¤„ç†æ¨èé€»è¾‘
})
```

## æ¶æ„è¯„åˆ†

### å„ç»´åº¦è¯„åˆ† (æ»¡åˆ†10åˆ†)

- **æ€§èƒ½**: 7/10 (åŸºæœ¬ä¼˜åŒ–ï¼Œä½†è¿˜æœ‰æå‡ç©ºé—´)
- **å®‰å…¨æ€§**: 8/10 (åŸºç¡€å®‰å…¨æªæ–½å®Œå–„)
- **å¯ç»´æŠ¤æ€§**: 9/10 (ä»£ç ç»“æ„æ¸…æ™°ï¼ŒTypeScriptæ”¯æŒ)
- **å¯æ‰©å±•æ€§**: 6/10 (å•ä½“æ¶æ„é™åˆ¶æ‰©å±•æ€§)
- **å¼€å‘æ•ˆç‡**: 9/10 (ç°ä»£åŒ–å·¥å…·é“¾ï¼Œå¼€å‘ä½“éªŒå¥½)
- **éƒ¨ç½²ä¾¿åˆ©æ€§**: 8/10 (Verceléƒ¨ç½²ç®€å•)

### æ€»ä½“è¯„åˆ†ï¼š7.8/10

## æ€»ç»“

RandomLifeçš„æŠ€æœ¯æ¶æ„é‡‡ç”¨äº†å½“å‰ä¸»æµçš„å…¨æ ˆå¼€å‘æ¨¡å¼ï¼Œå…·æœ‰è‰¯å¥½çš„å¼€å‘ä½“éªŒå’Œä»£ç è´¨é‡ã€‚å¯¹äºMVPé˜¶æ®µçš„äº§å“æ¥è¯´ï¼Œè¿™ä¸ªæ¶æ„æ˜¯åˆé€‚çš„é€‰æ‹©ã€‚ä½†éšç€ç”¨æˆ·è§„æ¨¡çš„å¢é•¿ï¼Œéœ€è¦è€ƒè™‘å‘å¾®æœåŠ¡æ¶æ„æ¼”è¿›ï¼Œå¼•å…¥æ›´ä¸“ä¸šçš„ç¼“å­˜ã€ç›‘æ§å’Œéƒ¨ç½²æ–¹æ¡ˆã€‚

**æ¶æ„ä¼˜åŠ¿**:
- âœ… ç°ä»£åŒ–æŠ€æœ¯æ ˆ
- âœ… è‰¯å¥½çš„å¼€å‘ä½“éªŒ
- âœ… ç±»å‹å®‰å…¨ä¿éšœ
- âœ… éƒ¨ç½²ç®€å•

**æ”¹è¿›æ–¹å‘**:
- ğŸ”§ å¼•å…¥ä¸“ä¸šç¼“å­˜æ–¹æ¡ˆ
- ğŸ”§ å®Œå–„ç›‘æ§å’Œæ—¥å¿—ç³»ç»Ÿ
- ğŸ”§ è€ƒè™‘æ•°æ®åº“å‡çº§
- ğŸ”§ å‡†å¤‡å¾®æœåŠ¡è¿ç§»